---
import { Image } from "astro:assets";

interface TeamMember {
	name: string;
	role: string;
	phone: string;
	image: string;
	bio: string[];
}

interface Props {
	title: string;
	subtitle: string;
	members: TeamMember[];
}

const { title, subtitle, members } = Astro.props;

// Dynamic image imports
const images = import.meta.glob<{ default: ImageMetadata }>(
	"/src/assets/pages/team/*.{png,jpg,jpeg,webp}"
);
---

<div class="items-center flex-col text-sm font-medium relative w-full pb-20">
	<!-- Header Section -->
	<div class="font-semibold mb-16 lg:mb-24">
		<div
			class="auto-cols-fr grid-cols-1 lg:grid-cols-[.5fr_1fr] grid-rows-[auto] grid gap-[1.88rem]"
		>
			<div class="col-span-1 row-span-1 text-[2.50rem] leading-none">
				<div class="items-center flex">
					<div class="text-4xl lg:text-5xl font-bold">{title}</div>
				</div>
			</div>
			<div class="col-span-1 row-span-1 text-xl lg:text-2xl">
				<p class="text-neutral-600" set:html={subtitle} />
			</div>
		</div>
	</div>

	<!-- Team Members -->
	<div class="space-y-24 lg:space-y-32">
		{members.map(async (member, index) => {
			const imagePath = member.image;
			const imageModule = images[imagePath];
			const image = imageModule ? (await imageModule()).default : null;

			return (
				<div class="team-member">
					<div class={`auto-cols-fr grid-cols-1 lg:grid-cols-2 grid-rows-[auto] grid gap-8 lg:gap-16 items-center ${index % 2 === 1 ? 'lg:[&>*:first-child]:order-2' : ''}`}>
						{/* Image */}
						<div class="col-span-1 row-span-1">
							<div class="relative overflow-hidden rounded-2xl lg:rounded-3xl aspect-[4/5] bg-neutral-100">
								{image && (
									<Image
										src={image}
										alt={member.name}
										class="object-cover w-full h-full"
										widths={[400, 600, 800]}
										sizes="(max-width: 768px) 100vw, 50vw"
									/>
								)}
								<div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent" />
							</div>
						</div>

						{/* Content */}
						<div class="col-span-1 row-span-1">
							<div class="lg:max-w-lg">
								<h2 class="text-3xl lg:text-4xl font-bold text-neutral-900 mb-2">
									{member.name}
								</h2>
								<p class="text-lg lg:text-xl font-semibold accent-red mb-6">
									{member.role}
								</p>

								<div class="space-y-4 text-neutral-600 text-base lg:text-lg leading-relaxed mb-8">
									{member.bio.map((paragraph) => (
										<p>{paragraph}</p>
									))}
								</div>

								<div class="flex items-center gap-3 pt-4 border-t border-neutral-200">
									<div class="flex items-center justify-center w-10 h-10 rounded-full bg-neutral-100">
										<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-neutral-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
											<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
										</svg>
									</div>
									<a
										href={`tel:${member.phone.replace(/[^0-9+]/g, '')}`}
										class="text-neutral-900 font-semibold hover:accent-red transition-colors"
									>
										{member.phone}
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			);
		})}
	</div>
</div>
